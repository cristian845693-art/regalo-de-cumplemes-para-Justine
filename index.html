<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para mi niña favorita</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Poppins:wght@300;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --color-fondo: #ffebee;
            --color-sobre: #ff8a80;
            --color-tapa: #ff5252;
            --color-carta: #ffffff;
        }

        body {
            background-color: var(--color-fondo);
            margin: 0;
            font-family: 'Poppins', sans-serif;
            overflow-y: auto;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* --- CORAZONES FLOTANTES --- */
        .floating-heart {
            position: fixed;
            color: rgba(255, 82, 82, 0.6);
            font-size: 20px;
            z-index: 1;
            pointer-events: none;
            animation: moveHeart 6s linear infinite;
            will-change: transform;
        }

        @keyframes moveHeart {
            0% { transform: translateY(105vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }

        /* --- CONTADOR FIJO --- */
        #timer-container {
            position: fixed;
            top: 15px;
            text-align: center;
            z-index: 5000;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 25px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        #timer { font-weight: 600; color: #444; font-size: 13px; }

        /* --- GALERÍA --- */
        #gallery-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(5, 1fr);
            padding: 25px;
            box-sizing: border-box;
            pointer-events: none;
            height: 100vh;
        }

        .photo-slot { display: flex; align-items: center; justify-content: center; }

        .photo {
            width: 110px; 
            background: white;
            padding: 5px 5px 15px 5px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            z-index: 5;
            pointer-events: auto;
            animation: floating 6s infinite ease-in-out;
        }

        .photo img { width: 100%; height: 95px; object-fit: cover; border-radius: 2px; }

        .photo:hover {
            animation: none !important;
            z-index: 6000 !important;
            transform: scale(2.8) rotate(0deg) translate3d(0,0,0) !important; 
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
        }

        /* --- SOBRE FIJO --- */
        .envelope-wrapper {
            position: fixed;
            width: 260px;
            height: 180px;
            background: var(--color-sobre);
            border-bottom-left-radius: 10px;
            border-bottom-right-radius: 10px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            z-index: 1000;
            cursor: pointer;
        }

        .envelope-wrapper::before {
            content: "";
            position: absolute; top: 0; z-index: 35;
            border-left: 130px solid transparent;
            border-right: 130px solid transparent;
            border-top: 100px solid var(--color-tapa);
            transform-origin: top;
            transition: transform 0.5s ease;
        }

        .envelope-front {
            position: absolute; bottom: 0; z-index: 30;
            border-left: 130px solid transparent;
            border-right: 130px solid transparent;
            border-bottom: 100px solid var(--color-sobre);
        }

        .letter {
            position: absolute;
            bottom: 10px; left: 10px;
            width: 240px; height: 160px;
            background: white;
            z-index: 20;
            padding: 15px;
            box-sizing: border-box;
            transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 5px;
            opacity: 0;
            visibility: hidden;
        }

        .letter-content {
            width: 100%; height: 100%;
            overflow-y: auto;
            padding-right: 5px;
            text-align: center;
        }

        .open::before { transform: rotateX(180deg); }
        .open .letter {
            transform: translateY(-130px) scale(1.3);
            z-index: 4000;
            opacity: 1;
            visibility: visible;
            height: 330px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .letter img { width: 85px; height: 85px; border-radius: 50%; object-fit: cover; margin-bottom: 10px; border: 2px solid var(--color-fondo); }
        .letter h3 { font-family: 'Dancing Script', cursive; font-size: 22px; color: var(--color-tapa); margin: 0; }
        .letter p { font-size: 13px; color: #555; line-height: 1.4; }

        @media (max-width: 768px) {
            #gallery-container { 
                grid-template-columns: repeat(2, 1fr); 
                grid-template-rows: repeat(12, 1fr); 
                height: 220vh;
                padding: 100px 20px; 
                gap: 25px; 
            }
            .photo { width: 130px; }
            .photo img { height: 110px; }
            .photo:hover { transform: scale(1.8) !important; }
            .envelope-wrapper { transform: scale(0.8); }
            .open .letter { transform: translateY(-100px) scale(1.1); width: 280px; left: -10px; }
        }

        @keyframes floating {
            0% { transform: translateY(0px) rotate(var(--r)); }
            50% { transform: translateY(-12px) rotate(calc(var(--r) + 2deg)); }
            100% { transform: translateY(0px) rotate(var(--r)); }
        }

        .confetti { position: fixed; width: 6px; height: 6px; z-index: 7000; border-radius: 50%; pointer-events: none; }
    </style>
</head>
<body>

    <audio id="musica" loop>
        <source src="audio/cancion_especial.mp3" type="audio/mpeg">
    </audio>

    <div id="timer-container">
        <div id="timer">Cargando nuestro tiempo...</div>
    </div>

    <div id="gallery-container"></div>

    <div class="envelope-wrapper" id="envelope" onclick="manejarApertura()">
        <div class="envelope-front"></div>
        <div class="letter">
            <div class="letter-content">
                <img src="img/nosotros.jpeg" alt="Nosotros">
                <h3>¡Feliz primer mes!</h3>
                <p>
                    <b>Mi niña hermosa Justine ❤️,</b><br><br>
                    Me robe un pedacito de internet para escribirte algo bonito, ya que el día de hoy estaremos de forma virtual viviendo este momento, pero dejame decirte que aunque estemos a la distancia, como siempre te siento mas cerca que nunca, Te amo mucho.
                    Ojalá no te parezca tan mamón esto mi amor, pero va con mucho cariño.
                    Justine parece increíble que ya haya pasado un mes desde que comenzamos esta linda aventura, desde que te conocí el tiempo al lado tuyo siempre pasa volando!!. <br><br>
                    Cada día ha sido hermoso, te he podido conocer en tus lados tiernos, vulnerables, en tus delirios y en la cotidianidad compartiendo con tu familia, y sin duda cada día me enamoro más de ti y de tu forma de ser.
                    y como tu sabes, genuinamente me gusta sacar fotos y guardar todos nuestros delirios, Cada una de estas 19 fotos es un pedacito de lo feliz que me haces. Gracias por estar conmigo y por cada momento compartido. ❤️
                </p>
                <p style="font-size: 11px; color: #aaa; margin-top: 15px;">(Desliza para leer más)</p>
            </div>
        </div>
    </div>

    <script>
        const startDate = new Date(2026, 0, 7, 0, 0); 
        const TOTAL_FOTOS = 19; 

        function generarGaleria() {
            const container = document.getElementById('gallery-container');
            const isMobile = window.innerWidth <= 768;
            const excludedMobile = [8, 9, 10, 11, 12, 13]; 
            const excludedPC = [9,10,11, 16,17,18, 23,24,25];
            const excluded = isMobile ? excludedMobile : excludedPC;
            const totalCells = isMobile ? 24 : 35;

            let photoIndex = 1;
            for (let i = 0; i < totalCells; i++) {
                const slot = document.createElement('div');
                slot.className = 'photo-slot';
                if (!excluded.includes(i) && photoIndex <= TOTAL_FOTOS) {
                    const photo = document.createElement('div');
                    photo.className = 'photo';
                    const r = (Math.random() * 10) - 5;
                    photo.style.setProperty('--r', r + 'deg');
                    photo.style.animationDelay = (Math.random() * 5) + 's';
                    photo.innerHTML = `<img src="img/foto${photoIndex}.jpeg" alt="Foto ${photoIndex}">`;
                    slot.appendChild(photo);
                    photoIndex++;
                }
                container.appendChild(slot);
            }
        }

        function updateTimer() {
            const now = new Date();
            const diff = now - startDate;
            const d = Math.floor(diff / (1000*60*60*24));
            const h = Math.floor((diff % (1000*60*60*24)) / (1000*60*60));
            const m = Math.floor((diff % (1000*60*60)) / (1000*60));
            const s = Math.floor((diff % (1000*60)) / 1000);
            document.getElementById('timer').innerHTML = `Llevamos: ${d}d ${h}h ${m}m ${s}s`;
        }

        // --- FUNCIÓN DE LOS CORAZONES ---
        function createHeart() {
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.innerHTML = '❤️';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.fontSize = (Math.random() * 10 + 15) + 'px';
            heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 6000);
        }

        function manejarApertura() {
            const env = document.getElementById('envelope');
            const audio = document.getElementById('musica');
            if(!env.classList.contains('open')) {
                env.classList.add('open');
                lanzarConfeti();
                audio.play().catch(() => {});
            } else {
                env.classList.remove('open');
                audio.pause();
            }
        }

        function lanzarConfeti() {
            for(let i=0; i<60; i++) {
                const c = document.createElement('div');
                c.className = 'confetti';
                c.style.left = '50%'; c.style.top = '50%';
                c.style.backgroundColor = ['#ff5252','#ff8a80','#ffd740','#ffffff'][Math.floor(Math.random()*4)];
                document.body.appendChild(c);
                const a = Math.random()*Math.PI*2; const v = Math.random()*15+5;
                let x=0, y=0, g=0.5; let vx=Math.cos(a)*v; let vy=Math.sin(a)*v-10;
                const interval = setInterval(() => {
                    x+=vx; y+=vy; vy+=g;
                    c.style.transform = `translate(${x}px, ${y}px) rotate(${x}deg)`;
                    if(y > window.innerHeight) { clearInterval(interval); c.remove(); }
                }, 20);
            }
        }

        window.onload = () => {
            generarGaleria();
            setInterval(updateTimer, 1000);
            setInterval(createHeart, 400); // Lanza corazones cada 400ms
            updateTimer();
        };
    </script>
</body>
</html>
